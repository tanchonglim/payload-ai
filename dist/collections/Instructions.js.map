{"version":3,"sources":["../../src/collections/Instructions.ts"],"sourcesContent":["import type { CollectionConfig, GroupField } from 'payload'\n\nimport { GenerationModels } from '../ai/models/index.js'\nimport { PLUGIN_INSTRUCTIONS_TABLE } from '../defaults.js'\n\nconst groupSettings = GenerationModels.reduce((fields, model) => {\n  if (model.settings) {\n    fields.push(model.settings)\n  }\n  return fields\n}, [] as GroupField[])\n\nconst modelOptions = GenerationModels.map((model) => {\n  return {\n    fields: model.fields,\n    label: model.name,\n    value: model.id,\n  }\n})\n\nconst defaultAccessConfig = {\n  create: () => true,\n  read: () => true,\n  update: () => true,\n}\n\nconst defaultAdminConfig = {\n  group: 'Plugins',\n  hidden: true,\n}\n\nexport const instructionsCollection = (options?: Partial<CollectionConfig>) =>\n  <CollectionConfig>{\n    slug: PLUGIN_INSTRUCTIONS_TABLE,\n    access: {\n      ...defaultAccessConfig,\n      ...options?.access,\n    },\n    admin: {\n      ...defaultAdminConfig,\n      ...options?.admin,\n      group: 'Plugins',\n    },\n    fields: [\n      {\n        name: 'schema-path',\n        type: 'text',\n        admin: {\n          readOnly: true,\n        },\n        unique: true,\n      },\n      {\n        name: 'field-type',\n        type: 'select',\n        admin: {\n          readOnly: true,\n        },\n        defaultValue: 'text',\n        label: 'Field type',\n        options: [\n          {\n            label: 'text',\n            value: 'text',\n          },\n          {\n            label: 'textarea',\n            value: 'textarea',\n          },\n          {\n            label: 'upload',\n            value: 'upload',\n          },\n          {\n            label: 'richText',\n            value: 'richText',\n          },\n        ],\n      },\n      {\n        name: 'relation-to',\n        type: 'text',\n        admin: {\n          condition: (_, current) => {\n            return current['field-type'] === 'upload'\n          },\n        },\n        label: 'Relation to',\n      },\n      {\n        name: 'model-id',\n        type: 'select',\n        admin: {\n          components: {\n            Field: {\n              clientProps: {\n                filterByField: 'field-type',\n                options: modelOptions,\n              },\n              path: '@ai-stack/payloadcms/fields#SelectField',\n            },\n          },\n        },\n        label: 'Model',\n        options: modelOptions.map((option) => {\n          return {\n            label: option.label,\n            value: option.value,\n          }\n        }),\n      },\n      {\n        id: 'ai-prompts-tabs',\n        type: 'tabs',\n        tabs: [\n          { // TODO: Add some info about the field to guide user\n            description: 'The Prompt field allows you to define dynamic templates using placeholders (e.g., {{ fieldName }}) to customize output based on your data fields.',\n            fields: [\n              {\n                name: 'prompt',\n                type: 'textarea',\n                admin: {\n                  components: {\n                    Field: '@ai-stack/payloadcms/fields#PromptEditorField',\n                  },\n                },\n                label: '',\n              },\n            ],\n            label: 'Prompt',\n          },\n          {\n            description: '',\n            fields: [\n              {\n                name: 'system',\n                type: 'textarea',\n                admin: {\n                  condition: (_, current) => {\n                    return current['field-type'] === 'richText'\n                  },\n                },\n                defaultValue: `INSTRUCTIONS:\nYou are a highly skilled and professional blog writer,\nrenowned for crafting engaging and well-organized articles.\nWhen given a title, you meticulously create blogs that are not only\ninformative and accurate but also captivating and beautifully structured.`,\n                label: '',\n              },\n            ],\n            label: 'System prompt',\n          },\n          {\n            // Note: Update when tabs PR is merged: https://github.com/payloadcms/payload/pull/8406\n            // admin: {\n            //   condition: (_, current) => {\n            //     console.log('condition in tab', current)\n            //     return current['field-type'] === 'richText'\n            //   },\n            // },\n            description: '',\n            fields: [\n              {\n                /**TODO's:\n                 *  - Layouts can be saved in as an array\n                 *  - user can add their own layout to collections and use it later for generate specific rich text\n                 *  - user can select previously added layout\n                 */\n                name: 'layout',\n                type: 'textarea',\n                admin: {\n                  condition: (_, current) => {\n                    return current['field-type'] === 'richText'\n                  },\n                },\n                defaultValue: `[paragraph] - Write a concise introduction (2-3 sentences) that outlines the main topic.\n[horizontalrule] - Insert a horizontal rule to separate the introduction from the main content.\n[list] - Create a list with 3-5 items. Each list item should contain:\n   a. [heading] - A brief, descriptive heading (up to 5 words)\n   b. [paragraph] - A short explanation or elaboration (1-2 sentences)\n[horizontalrule] - Insert another horizontal rule to separate the main content from the conclusion.\n[paragraph] - Compose a brief conclusion (2-3 sentences) summarizing the key points.\n[quote] - Include a relevant quote from a famous person, directly related to the topic. Format: \"Quote text.\" - Author Name`,\n                label: '',\n              },\n            ],\n            label: 'Layout',\n          },\n        ],\n      },\n      ...groupSettings,\n    ],\n    labels: {\n      plural: 'Compose Settings',\n      singular: 'Compose Setting',\n    },\n  }\n"],"names":["GenerationModels","PLUGIN_INSTRUCTIONS_TABLE","groupSettings","reduce","fields","model","settings","push","modelOptions","map","label","name","value","id","defaultAccessConfig","create","read","update","defaultAdminConfig","group","hidden","instructionsCollection","options","slug","access","admin","type","readOnly","unique","defaultValue","condition","_","current","components","Field","clientProps","filterByField","path","option","tabs","description","labels","plural","singular"],"mappings":"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"}